{% extends 'base.html' %}
{% load static %}

{% block title %}
Bag
{% endblock %}

{% block content %}

<h1 class="p-3 py-4 m-0 text-center">Shopping Kart</h1>

<div class="row m-0 p-3 bg-light justify-content-center">
    <div class="col-7 m-0">
        <div class="checkout-container white-container">
            {% if bag_items %}
            <table class="container-fluid shopping-bag-table">
                <tr>
                    <th>Product Info</th>
                    <th>Price</th>
                    <th>Set</th>
                    <th>Qty</th>
                    <th>Subtotal</th>
                </tr>

                {% for product in bag_items %}
                <tr>
                    <td class="d-flex justify-content-start">
                        {% if product.item == 'front' %}
                        <div class="d-flex justify-content-center">
                            <div id="viewFrontPlate"
                                class="checkout-number-plate-container number-plate-container-yellow mb-2">
                                <p class="checkout-number-plate-font" id="white-number-plate">{{ product.reg_number }}
                                </p>
                            </div>
                        </div>
                        <h6 class="capitalize mx-3">Uk Number Plate Replacement</h6>
                        {% elif product.item == 'back' %}
                        <div class="d-flex justify-content-center">
                            <div id="viewFrontPlate"
                                class="checkout-number-plate-container number-plate-container-white mb-2">
                                <p class="checkout-number-plate-font" id="white-number-plate">{{ product.reg_number }}
                                </p>
                            </div>
                        </div>
                        <h6 class="capitalize mx-3">Uk Number Plate Replacement</h6>
                        {% elif product.item == 'both' %}
                        <div class="d-flex justify-content-center align-items-center">
                            <div id="plateContainer">
                                <div id="viewFrontPlate"
                                    class="checkout-number-plate-container number-plate-container-yellow mb-2">
                                    <p class="checkout-number-plate-font" id="white-number-plate">
                                        {{ product.reg_number }}
                                    </p>
                                </div>
                                <div id="viewBackPlate"
                                    class="checkout-number-plate-container number-plate-container-white">
                                    <p class="checkout-number-plate-font" id="yellow-number-plate">
                                        {{ product.reg_number }}
                                    </p>
                                </div>
                            </div>
                        </div>
                        <h6 class="capitalize mx-3">Uk Number Plate Replacement</h6>
                        {% else %}
                        <p><img src="{% static 'media/fitting-kit.jpg' %}" style="width: 120px;"></p>
                        <h6 class="capitalize mx-3">Fitting Kit</h6>
                        {% endif %}

                    </td>
                    <td>
                        <p>£{{ product.cost }}</p>
                    </td>
                    <td>
                        <p class="capitalize">{{ product.item }}</p>
                    </td>
                    <td style="width: 50px">
                        <input type="number" class="form-control" value="{{ product.quantity }}">
                        <a class="text-info text-center mt-2"
                            href="{% url 'remove_from_bag' product.id %}"><small>Update</small></a>
                        <a class="text-danger text-center mt-2"
                            href="{% url 'remove_from_bag' product.id %}"><small>Remove</small></a>
                    </td>
                    <td>
                        <p>£{{ product.cost }}</p>
                    </td>
                </tr>
                {% endfor %}

            </table>
            <a class="btn btn-danger mt-2" href="{% url 'empty_basket' %}">Empty Basket</a>
            {% else %}
            <div class="p-3">
                <p class="text-center">You currently have no items in your basket.</p>
                <div class="d-flex justify-content-center">
                    <a class="btn bg-main" href="{% url 'design_plates' %}">Start Shopping</a>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    {% if bag_items %}
    <div class="col-3 m-0 p-0">
        {% if not fitting_kit %}
        <div class="checkout-container white-container p-3 mb-3">
            {% if free_delivery_delta > 0 %}
            <p>Spend £{{ free_delivery_delta }} to get
                free
                delivery!</p>
            <hr>
            {% endif %}
            <img src="{% static 'media/fitting-kit.jpg' %}" style="width: 80px;" class="d-block mx-auto">
            <p class="mt-2 text-center">Fitting kit only £4.99</p>
            <form action="{% url 'add_to_bag' %}" method="POST">
                {% csrf_token %}
                <input type="hidden" name="fitting-kit" value="on">
                <button class="btn bg-main container-fluid">Add to
                    basket</button>
            </form>

        </div>
        {% endif %}
        <div class="checkout-container white-container p-3">
            <p>Total Item cost: £ {{ total }}</p>
            <p>Delivery: £{{ delivery }}</p>
            <h5>Total £{{ grand_total }}</h5>
            <a class="btn btn-success container-fluid py-3" href="{% url 'design_plates' %}">Check Out</a>
        </div>
    </div>
    {% endif %}
</div>





{% endblock %}